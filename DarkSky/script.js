var hasAlerts;

function initialize()
{
    $('#theme').attr('href', 'theme/' + theme + '.css');
	hideUnwantedData();
	$("#apparentTempLabel").text(apparentTempLabel);
	$("#windLabel").text(windLabel);
	showDateTime();
	getForecast();
	
	var t = setInterval(showDateTime, 500);
	var f = setInterval(getForecast, 300000);
}

function getForecast()
{
	/*
    //var sampleData = '{"latitude":45.5581968,"longitude":-73.8516448,"timezone":"America/Montreal","offset":-4,"currently":{"time":1489932325,"summary":"Clear","icon":"clear-day","nearestStormDistance":182,"nearestStormBearing":156,"precipIntensity":0,"precipProbability":0,"temperature":-5.95,"apparentTemperature":-10.01,"dewPoint":-8.53,"humidity":0.82,"windSpeed":2.45,"windBearing":22,"visibility":16.09,"cloudCover":0.15,"pressure":1028.11,"ozone":373.93},"minutely":{"summary":"Clear for the hour.","icon":"clear-day","data":[{"time":1489932300,"precipIntensity":0,"precipProbability":0},{"time":1489932360,"precipIntensity":0,"precipProbability":0},{"time":1489932420,"precipIntensity":0,"precipProbability":0},{"time":1489932480,"precipIntensity":0,"precipProbability":0},{"time":1489932540,"precipIntensity":0,"precipProbability":0},{"time":1489932600,"precipIntensity":0,"precipProbability":0},{"time":1489932660,"precipIntensity":0,"precipProbability":0},{"time":1489932720,"precipIntensity":0,"precipProbability":0},{"time":1489932780,"precipIntensity":0,"precipProbability":0},{"time":1489932840,"precipIntensity":0,"precipProbability":0},{"time":1489932900,"precipIntensity":0,"precipProbability":0},{"time":1489932960,"precipIntensity":0,"precipProbability":0},{"time":1489933020,"precipIntensity":0,"precipProbability":0},{"time":1489933080,"precipIntensity":0,"precipProbability":0},{"time":1489933140,"precipIntensity":0,"precipProbability":0},{"time":1489933200,"precipIntensity":0,"precipProbability":0},{"time":1489933260,"precipIntensity":0,"precipProbability":0},{"time":1489933320,"precipIntensity":0,"precipProbability":0},{"time":1489933380,"precipIntensity":0,"precipProbability":0},{"time":1489933440,"precipIntensity":0,"precipProbability":0},{"time":1489933500,"precipIntensity":0,"precipProbability":0},{"time":1489933560,"precipIntensity":0,"precipProbability":0},{"time":1489933620,"precipIntensity":0,"precipProbability":0},{"time":1489933680,"precipIntensity":0,"precipProbability":0},{"time":1489933740,"precipIntensity":0,"precipProbability":0},{"time":1489933800,"precipIntensity":0,"precipProbability":0},{"time":1489933860,"precipIntensity":0,"precipProbability":0},{"time":1489933920,"precipIntensity":0,"precipProbability":0},{"time":1489933980,"precipIntensity":0,"precipProbability":0},{"time":1489934040,"precipIntensity":0,"precipProbability":0},{"time":1489934100,"precipIntensity":0,"precipProbability":0},{"time":1489934160,"precipIntensity":0,"precipProbability":0},{"time":1489934220,"precipIntensity":0,"precipProbability":0},{"time":1489934280,"precipIntensity":0,"precipProbability":0},{"time":1489934340,"precipIntensity":0,"precipProbability":0},{"time":1489934400,"precipIntensity":0,"precipProbability":0},{"time":1489934460,"precipIntensity":0,"precipProbability":0},{"time":1489934520,"precipIntensity":0,"precipProbability":0},{"time":1489934580,"precipIntensity":0,"precipProbability":0},{"time":1489934640,"precipIntensity":0,"precipProbability":0},{"time":1489934700,"precipIntensity":0,"precipProbability":0},{"time":1489934760,"precipIntensity":0,"precipProbability":0},{"time":1489934820,"precipIntensity":0,"precipProbability":0},{"time":1489934880,"precipIntensity":0,"precipProbability":0},{"time":1489934940,"precipIntensity":0,"precipProbability":0},{"time":1489935000,"precipIntensity":0,"precipProbability":0},{"time":1489935060,"precipIntensity":0,"precipProbability":0},{"time":1489935120,"precipIntensity":0,"precipProbability":0},{"time":1489935180,"precipIntensity":0,"precipProbability":0},{"time":1489935240,"precipIntensity":0,"precipProbability":0},{"time":1489935300,"precipIntensity":0,"precipProbability":0},{"time":1489935360,"precipIntensity":0,"precipProbability":0},{"time":1489935420,"precipIntensity":0,"precipProbability":0},{"time":1489935480,"precipIntensity":0,"precipProbability":0},{"time":1489935540,"precipIntensity":0,"precipProbability":0},{"time":1489935600,"precipIntensity":0,"precipProbability":0},{"time":1489935660,"precipIntensity":0,"precipProbability":0},{"time":1489935720,"precipIntensity":0,"precipProbability":0},{"time":1489935780,"precipIntensity":0,"precipProbability":0},{"time":1489935840,"precipIntensity":0,"precipProbability":0},{"time":1489935900,"precipIntensity":0,"precipProbability":0}]},"hourly":{"summary":"Foggy tomorrow morning.","icon":"fog","data":[{"time":1489932000,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":-5.95,"apparentTemperature":-9.99,"dewPoint":-8.59,"humidity":0.82,"windSpeed":2.44,"windBearing":22,"visibility":16.09,"cloudCover":0.12,"pressure":1028.1,"ozone":373.76},{"time":1489935600,"summary":"Partly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":-3.41,"apparentTemperature":-7.16,"dewPoint":-5.41,"humidity":0.86,"windSpeed":2.59,"windBearing":27,"visibility":14.13,"cloudCover":0.45,"pressure":1028.18,"ozone":375.67},{"time":1489939200,"summary":"Partly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":-1.58,"apparentTemperature":-5.07,"dewPoint":-3.99,"humidity":0.84,"windSpeed":2.67,"windBearing":24,"visibility":14.52,"cloudCover":0.37,"pressure":1027.94,"ozone":378.86},{"time":1489942800,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":-0.15,"apparentTemperature":-3.36,"dewPoint":-3.11,"humidity":0.8,"windSpeed":2.65,"windBearing":24,"visibility":14.47,"cloudCover":0.22,"pressure":1027.54,"ozone":382.62},{"time":1489946400,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":1.2,"apparentTemperature":-1.56,"dewPoint":-2.27,"humidity":0.78,"windSpeed":2.45,"windBearing":26,"visibility":14.84,"cloudCover":0.11,"pressure":1027.15,"ozone":384.78},{"time":1489950000,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":2.57,"apparentTemperature":0.27,"dewPoint":-1.12,"humidity":0.77,"windSpeed":2.24,"windBearing":24,"visibility":15.1,"cloudCover":0.09,"pressure":1026.75,"ozone":384.35},{"time":1489953600,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":2.37,"apparentTemperature":0.16,"dewPoint":-1.34,"humidity":0.76,"windSpeed":2.14,"windBearing":17,"visibility":15.19,"cloudCover":0.12,"pressure":1026.26,"ozone":382.33},{"time":1489957200,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":1.38,"apparentTemperature":-0.62,"dewPoint":-2.16,"humidity":0.77,"windSpeed":1.81,"windBearing":1,"visibility":15.34,"cloudCover":0.14,"pressure":1025.98,"ozone":379.58},{"time":1489960800,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":-0.23,"apparentTemperature":-1.84,"dewPoint":-3.13,"humidity":0.81,"windSpeed":1.39,"windBearing":2,"visibility":15.39,"cloudCover":0.16,"pressure":1025.86,"ozone":375.9},{"time":1489964400,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":-3.41,"apparentTemperature":-3.41,"dewPoint":-5.55,"humidity":0.85,"windSpeed":0.64,"windBearing":2,"visibility":14.71,"cloudCover":0.19,"pressure":1025.85,"ozone":371.5},{"time":1489968000,"summary":"Partly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-6.27,"apparentTemperature":-6.27,"dewPoint":-8.07,"humidity":0.87,"windSpeed":0.3,"windBearing":287,"visibility":13.21,"cloudCover":0.29,"pressure":1025.86,"ozone":367.82},{"time":1489971600,"summary":"Partly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-7.93,"apparentTemperature":-7.93,"dewPoint":-9.48,"humidity":0.89,"windSpeed":0.51,"windBearing":266,"visibility":10.64,"cloudCover":0.49,"pressure":1025.95,"ozone":365.75},{"time":1489975200,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-8.59,"apparentTemperature":-8.59,"dewPoint":-10.03,"humidity":0.89,"windSpeed":1.33,"windBearing":271,"visibility":7.64,"cloudCover":0.72,"pressure":1026.08,"ozone":364.4},{"time":1489978800,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-8.68,"apparentTemperature":-11.61,"dewPoint":-10.02,"humidity":0.9,"windSpeed":1.48,"windBearing":275,"visibility":5.83,"cloudCover":0.91,"pressure":1026.06,"ozone":362.61},{"time":1489982400,"summary":"Overcast","icon":"cloudy","precipIntensity":0,"precipProbability":0,"temperature":-8.74,"apparentTemperature":-11.77,"dewPoint":-10.24,"humidity":0.89,"windSpeed":1.52,"windBearing":272,"visibility":4.76,"cloudCover":0.95,"pressure":1025.77,"ozone":359.74},{"time":1489986000,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-9.08,"apparentTemperature":-11.99,"dewPoint":-10.53,"humidity":0.89,"windSpeed":1.44,"windBearing":266,"visibility":4.57,"cloudCover":0.93,"pressure":1025.33,"ozone":356.42},{"time":1489989600,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-9.37,"apparentTemperature":-9.37,"dewPoint":-10.83,"humidity":0.89,"windSpeed":1.15,"windBearing":260,"visibility":4.31,"cloudCover":0.9,"pressure":1024.93,"ozone":353.39},{"time":1489993200,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-9.03,"apparentTemperature":-9.03,"dewPoint":-10.08,"humidity":0.92,"windSpeed":1.06,"windBearing":264,"visibility":3.27,"cloudCover":0.91,"pressure":1024.61,"ozone":350.86},{"time":1489996800,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-8.83,"apparentTemperature":-8.83,"dewPoint":-9.56,"humidity":0.94,"windSpeed":0.96,"windBearing":265,"visibility":2.17,"cloudCover":0.91,"pressure":1024.3,"ozone":348.61},{"time":1490000400,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-8.87,"apparentTemperature":-8.87,"dewPoint":-9.4,"humidity":0.96,"windSpeed":0.85,"windBearing":262,"visibility":1.3,"cloudCover":0.91,"pressure":1024.02,"ozone":346.74},{"time":1490004000,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-9.09,"apparentTemperature":-9.09,"dewPoint":-9.52,"humidity":0.97,"windSpeed":0.76,"windBearing":251,"visibility":0.69,"cloudCover":0.91,"pressure":1023.79,"ozone":345.38},{"time":1490007600,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-8.29,"apparentTemperature":-8.29,"dewPoint":-8.63,"humidity":0.97,"windSpeed":0.68,"windBearing":235,"visibility":0,"cloudCover":0.91,"pressure":1023.58,"ozone":344.41},{"time":1490011200,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-7.96,"apparentTemperature":-7.96,"dewPoint":-8.38,"humidity":0.97,"windSpeed":0.69,"windBearing":219,"visibility":0.08,"cloudCover":0.91,"pressure":1023.31,"ozone":343.55},{"time":1490014800,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-6.63,"apparentTemperature":-6.63,"dewPoint":-7.24,"humidity":0.95,"windSpeed":0.68,"windBearing":207,"visibility":0,"cloudCover":0.94,"pressure":1022.99,"ozone":342.79},{"time":1490018400,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-4.72,"apparentTemperature":-4.72,"dewPoint":-5.61,"humidity":0.93,"windSpeed":0.71,"windBearing":201,"visibility":0,"cloudCover":0.98,"pressure":1022.56,"ozone":342.15},{"time":1490022000,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-2.73,"apparentTemperature":-2.73,"dewPoint":-3.92,"humidity":0.92,"windSpeed":0.81,"windBearing":196,"visibility":1.45,"cloudCover":0.99,"pressure":1022.01,"ozone":341.41},{"time":1490025600,"summary":"Overcast","icon":"cloudy","precipIntensity":0,"precipProbability":0,"temperature":-1.1,"apparentTemperature":-1.1,"dewPoint":-2.62,"humidity":0.89,"windSpeed":1.03,"windBearing":188,"visibility":5.89,"cloudCover":0.97,"pressure":1021.33,"ozone":340.27},{"time":1490029200,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":0.4,"apparentTemperature":0.4,"dewPoint":-1.49,"humidity":0.87,"windSpeed":1.3,"windBearing":182,"visibility":11.81,"cloudCover":0.92,"pressure":1020.55,"ozone":339.03},{"time":1490032800,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":1.74,"apparentTemperature":0.23,"dewPoint":-0.39,"humidity":0.86,"windSpeed":1.5,"windBearing":178,"visibility":16.09,"cloudCover":0.87,"pressure":1019.67,"ozone":338.38},{"time":1490036400,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":2.72,"apparentTemperature":1.23,"dewPoint":0.57,"humidity":0.86,"windSpeed":1.58,"windBearing":174,"visibility":16.09,"cloudCover":0.82,"pressure":1018.58,"ozone":338.74},{"time":1490040000,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":3.22,"apparentTemperature":1.79,"dewPoint":1.21,"humidity":0.87,"windSpeed":1.59,"windBearing":171,"visibility":16.09,"cloudCover":0.77,"pressure":1017.38,"ozone":339.69},{"time":1490043600,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":3.12,"apparentTemperature":1.7,"dewPoint":1.39,"humidity":0.88,"windSpeed":1.57,"windBearing":170,"visibility":16.09,"cloudCover":0.76,"pressure":1016.42,"ozone":340.63},{"time":1490047200,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":2.56,"apparentTemperature":1.1,"dewPoint":1.29,"humidity":0.91,"windSpeed":1.54,"windBearing":171,"visibility":16.09,"cloudCover":0.81,"pressure":1015.89,"ozone":341.27},{"time":1490050800,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":1.86,"apparentTemperature":0.4,"dewPoint":1.14,"humidity":0.95,"windSpeed":1.48,"windBearing":173,"visibility":16.09,"cloudCover":0.9,"pressure":1015.56,"ozone":341.91},{"time":1490054400,"summary":"Overcast","icon":"cloudy","precipIntensity":0,"precipProbability":0,"temperature":1.37,"apparentTemperature":-0.18,"dewPoint":1.01,"humidity":0.97,"windSpeed":1.49,"windBearing":181,"visibility":16.09,"cloudCover":0.98,"pressure":1015.21,"ozone":342.81},{"time":1490058000,"summary":"Overcast","icon":"cloudy","precipIntensity":0,"precipProbability":0,"temperature":1.16,"apparentTemperature":-0.84,"dewPoint":0.88,"humidity":0.98,"windSpeed":1.79,"windBearing":196,"visibility":11.23,"cloudCover":1,"pressure":1014.86,"ozone":343.9},{"time":1490061600,"summary":"Overcast","icon":"cloudy","precipIntensity":0,"precipProbability":0,"temperature":1.04,"apparentTemperature":-1.59,"dewPoint":0.72,"humidity":0.98,"windSpeed":2.32,"windBearing":208,"visibility":4.6,"cloudCover":1,"pressure":1014.5,"ozone":345.25},{"time":1490065200,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":0.88,"apparentTemperature":-2.3,"dewPoint":0.52,"humidity":0.97,"windSpeed":2.84,"windBearing":216,"visibility":0.34,"cloudCover":0.99,"pressure":1014.03,"ozone":347.36},{"time":1490068800,"summary":"Foggy","icon":"fog","precipIntensity":0.0406,"precipProbability":0.03,"precipType":"snow","precipAccumulation":0.03,"temperature":0.64,"apparentTemperature":-3.02,"dewPoint":0.31,"humidity":0.98,"windSpeed":3.34,"windBearing":221,"visibility":0.74,"cloudCover":1,"pressure":1013.37,"ozone":350.43},{"time":1490072400,"summary":"Flurries","icon":"snow","precipIntensity":0.0813,"precipProbability":0.11,"precipType":"snow","precipAccumulation":0.061,"temperature":0.48,"apparentTemperature":-3.52,"dewPoint":0.2,"humidity":0.98,"windSpeed":3.75,"windBearing":225,"visibility":3.51,"cloudCover":1,"pressure":1012.6,"ozone":354.25},{"time":1490076000,"summary":"Light Snow","icon":"snow","precipIntensity":0.1016,"precipProbability":0.15,"precipType":"snow","precipAccumulation":0.079,"temperature":0.39,"apparentTemperature":-3.78,"dewPoint":0.13,"humidity":0.98,"windSpeed":3.98,"windBearing":229,"visibility":5.7,"cloudCover":0.99,"pressure":1011.95,"ozone":358.67},{"time":1490079600,"summary":"Overcast","icon":"cloudy","precipIntensity":0.0813,"precipProbability":0.11,"precipType":"sleet","temperature":0.33,"apparentTemperature":-3.83,"dewPoint":0.02,"humidity":0.98,"windSpeed":3.93,"windBearing":234,"visibility":6.28,"cloudCover":0.96,"pressure":1011.46,"ozone":363.95},{"time":1490083200,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0.0381,"precipProbability":0.03,"precipType":"sleet","temperature":0.27,"apparentTemperature":-3.73,"dewPoint":-0.13,"humidity":0.97,"windSpeed":3.69,"windBearing":241,"visibility":6.29,"cloudCover":0.92,"pressure":1011.08,"ozone":369.82},{"time":1490086800,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-0.06,"apparentTemperature":-3.94,"dewPoint":-0.54,"humidity":0.97,"windSpeed":3.45,"windBearing":249,"visibility":5.92,"cloudCover":0.87,"pressure":1010.9,"ozone":375.38},{"time":1490090400,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-0.47,"apparentTemperature":-4.25,"dewPoint":-1.02,"humidity":0.96,"windSpeed":3.21,"windBearing":258,"visibility":4.51,"cloudCover":0.79,"pressure":1011.01,"ozone":380.29},{"time":1490094000,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-1.15,"apparentTemperature":-4.88,"dewPoint":-1.79,"humidity":0.95,"windSpeed":3,"windBearing":270,"visibility":2.7,"cloudCover":0.68,"pressure":1011.33,"ozone":384.88},{"time":1490097600,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-1.3,"apparentTemperature":-4.82,"dewPoint":-2.05,"humidity":0.95,"windSpeed":2.75,"windBearing":271,"visibility":2.75,"cloudCover":0.58,"pressure":1011.68,"ozone":389.26},{"time":1490101200,"summary":"Partly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":-0.48,"apparentTemperature":-3.77,"dewPoint":-1.39,"humidity":0.94,"windSpeed":2.67,"windBearing":267,"visibility":6.47,"cloudCover":0.49,"pressure":1012.14,"ozone":393.49},{"time":1490104800,"summary":"Partly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":0.84,"apparentTemperature":-2.19,"dewPoint":-0.27,"humidity":0.92,"windSpeed":2.67,"windBearing":259,"visibility":12.02,"cloudCover":0.4,"pressure":1012.53,"ozone":397.51}]},"daily":{"summary":"Mixed precipitation on Tuesday through Sunday, with temperatures bottoming out at -5°C on Wednesday.","icon":"snow","data":[{"time":1489896000,"summary":"Mostly cloudy starting in the evening.","icon":"partly-cloudy-night","sunriseTime":1489921276,"sunsetTime":1489964851,"moonPhase":0.72,"precipIntensity":0,"precipIntensityMax":0,"precipProbability":0,"temperatureMin":-9.79,"temperatureMinTime":1489906800,"temperatureMax":2.57,"temperatureMaxTime":1489950000,"apparentTemperatureMin":-13.45,"apparentTemperatureMinTime":1489906800,"apparentTemperatureMax":0.27,"apparentTemperatureMaxTime":1489950000,"dewPoint":-7.33,"humidity":0.81,"windSpeed":1.61,"windBearing":11,"visibility":16.09,"cloudCover":0.21,"pressure":1026.62,"ozone":373.74},{"time":1489982400,"summary":"Light snow overnight.","icon":"snow","sunriseTime":1490007561,"sunsetTime":1490051329,"moonPhase":0.75,"precipIntensity":0,"precipIntensityMax":0,"precipProbability":0,"temperatureMin":-9.37,"temperatureMinTime":1489989600,"temperatureMax":3.22,"temperatureMaxTime":1490040000,"apparentTemperatureMin":-11.99,"apparentTemperatureMinTime":1489986000,"apparentTemperatureMax":1.79,"apparentTemperatureMaxTime":1490040000,"dewPoint":-4.16,"humidity":0.93,"windSpeed":1.07,"windBearing":207,"visibility":7.18,"cloudCover":0.91,"pressure":1020.47,"ozone":344.78},{"time":1490068800,"summary":"Foggy in the morning.","icon":"fog","sunriseTime":1490093845,"sunsetTime":1490137807,"moonPhase":0.78,"precipIntensity":0.0279,"precipIntensityMax":0.1016,"precipIntensityMaxTime":1490076000,"precipProbability":0.15,"precipType":"snow","precipAccumulation":0.546,"temperatureMin":-5.48,"temperatureMinTime":1490151600,"temperatureMax":4.7,"temperatureMaxTime":1490126400,"apparentTemperatureMin":-11.83,"apparentTemperatureMinTime":1490151600,"apparentTemperatureMax":1.36,"apparentTemperatureMaxTime":1490126400,"dewPoint":-0.72,"humidity":0.91,"windSpeed":3.14,"windBearing":254,"visibility":11.15,"cloudCover":0.54,"pressure":1012.19,"ozone":399.55},{"time":1490155200,"summary":"Flurries starting in the afternoon, continuing until evening.","icon":"snow","sunriseTime":1490180130,"sunsetTime":1490224285,"moonPhase":0.81,"precipIntensity":0.0102,"precipIntensityMax":0.0229,"precipIntensityMaxTime":1490212800,"precipProbability":0.01,"precipType":"snow","precipAccumulation":0.404,"temperatureMin":-14.23,"temperatureMinTime":1490184000,"temperatureMax":-4.78,"temperatureMaxTime":1490155200,"apparentTemperatureMin":-21.99,"apparentTemperatureMinTime":1490184000,"apparentTemperatureMax":-11.13,"apparentTemperatureMaxTime":1490155200,"dewPoint":-14.87,"humidity":0.71,"windSpeed":4.68,"windBearing":295,"visibility":16.09,"cloudCover":0.37,"pressure":1025.97,"ozone":463.84},{"time":1490241600,"summary":"Mostly cloudy overnight.","icon":"partly-cloudy-night","sunriseTime":1490266414,"sunsetTime":1490310762,"moonPhase":0.85,"precipIntensity":0,"precipIntensityMax":0,"precipProbability":0,"temperatureMin":-11.94,"temperatureMinTime":1490266800,"temperatureMax":0.64,"temperatureMaxTime":1490302800,"apparentTemperatureMin":-17.94,"apparentTemperatureMinTime":1490266800,"apparentTemperatureMax":-3.59,"apparentTemperatureMaxTime":1490302800,"dewPoint":-8.66,"humidity":0.84,"windSpeed":3.92,"windBearing":263,"cloudCover":0.1,"pressure":1032.64,"ozone":431.54},{"time":1490328000,"summary":"Light rain starting in the afternoon.","icon":"rain","sunriseTime":1490352699,"sunsetTime":1490397240,"moonPhase":0.88,"precipIntensity":0.0787,"precipIntensityMax":0.2286,"precipIntensityMaxTime":1490392800,"precipProbability":0.48,"precipType":"snow","precipAccumulation":1.45,"temperatureMin":-5.48,"temperatureMinTime":1490346000,"temperatureMax":5.02,"temperatureMaxTime":1490410800,"apparentTemperatureMin":-8.17,"apparentTemperatureMinTime":1490349600,"apparentTemperatureMax":3.49,"apparentTemperatureMaxTime":1490410800,"dewPoint":-1.99,"humidity":0.89,"windSpeed":1.55,"windBearing":154,"cloudCover":0.88,"pressure":1026.2,"ozone":346.87},{"time":1490414400,"summary":"Mixed precipitation (6–13 cm. of snow) throughout the day.","icon":"rain","sunriseTime":1490438983,"sunsetTime":1490483718,"moonPhase":0.91,"precipIntensity":0.635,"precipIntensityMax":1.6231,"precipIntensityMaxTime":1490490000,"precipProbability":0.75,"precipType":"rain","temperatureMin":-0.21,"temperatureMinTime":1490497200,"temperatureMax":8.39,"temperatureMaxTime":1490461200,"apparentTemperatureMin":-5.23,"apparentTemperatureMinTime":1490497200,"apparentTemperatureMax":5.35,"apparentTemperatureMaxTime":1490461200,"dewPoint":4.54,"humidity":0.96,"windSpeed":1.12,"windBearing":270,"cloudCover":1,"pressure":1013.91,"ozone":328.48},{"time":1490500800,"summary":"Snow (2–5 cm.) throughout the day.","icon":"snow","sunriseTime":1490525268,"sunsetTime":1490570195,"moonPhase":0.95,"precipIntensity":0.2769,"precipIntensityMax":1.3335,"precipIntensityMaxTime":1490500800,"precipProbability":0.73,"precipType":"snow","precipAccumulation":7.198,"temperatureMin":-6.77,"temperatureMinTime":1490533200,"temperatureMax":-0.47,"temperatureMaxTime":1490500800,"apparentTemperatureMin":-14.46,"apparentTemperatureMinTime":1490533200,"apparentTemperatureMax":-5.62,"apparentTemperatureMaxTime":1490500800,"dewPoint":-6.29,"humidity":0.85,"windSpeed":5.82,"windBearing":44,"cloudCover":0.77,"pressure":1024.11,"ozone":363.71}]},"flags":{"sources":["gfs","cmc","nam","rap","rtma","sref","fnmoc","isd","madis","nearest-precip","ecpa","darksky"],"isd-stations":["711830-99999","711840-99999","713710-99999","713713-99999","713720-99999","713770-99999","713985-99999","715240-99999","716120-99999","716140-99999","716260-99999","716270-94792","716270-99999","716275-99999","719050-99999","999999-94792"],"madis-stations":["AS947","C3442","C7439","C8027","C8480","CWTA","CWVQ","CYMX","CYUL","D2821","D3464","D8252","E5619","VCBW","VCWS","XJBH"],"units":"si"}}';
	var sampleDataWithAlerts = '{"latitude":45.5581968,"longitude":-73.8516448,"timezone":"America/Montreal","offset":-4,"currently":{"time":1489932325,"summary":"Clear","icon":"clear-day","nearestStormDistance":182,"nearestStormBearing":156,"precipIntensity":0,"precipProbability":0,"temperature":-5.95,"apparentTemperature":-10.01,"dewPoint":-8.53,"humidity":0.82,"windSpeed":2.45,"windBearing":22,"visibility":16.09,"cloudCover":0.15,"pressure":1028.11,"ozone":373.93},"minutely":{"summary":"Clear for the hour.","icon":"clear-day","data":[{"time":1489932300,"precipIntensity":0,"precipProbability":0},{"time":1489932360,"precipIntensity":0,"precipProbability":0},{"time":1489932420,"precipIntensity":0,"precipProbability":0},{"time":1489932480,"precipIntensity":0,"precipProbability":0},{"time":1489932540,"precipIntensity":0,"precipProbability":0},{"time":1489932600,"precipIntensity":0,"precipProbability":0},{"time":1489932660,"precipIntensity":0,"precipProbability":0},{"time":1489932720,"precipIntensity":0,"precipProbability":0},{"time":1489932780,"precipIntensity":0,"precipProbability":0},{"time":1489932840,"precipIntensity":0,"precipProbability":0},{"time":1489932900,"precipIntensity":0,"precipProbability":0},{"time":1489932960,"precipIntensity":0,"precipProbability":0},{"time":1489933020,"precipIntensity":0,"precipProbability":0},{"time":1489933080,"precipIntensity":0,"precipProbability":0},{"time":1489933140,"precipIntensity":0,"precipProbability":0},{"time":1489933200,"precipIntensity":0,"precipProbability":0},{"time":1489933260,"precipIntensity":0,"precipProbability":0},{"time":1489933320,"precipIntensity":0,"precipProbability":0},{"time":1489933380,"precipIntensity":0,"precipProbability":0},{"time":1489933440,"precipIntensity":0,"precipProbability":0},{"time":1489933500,"precipIntensity":0,"precipProbability":0},{"time":1489933560,"precipIntensity":0,"precipProbability":0},{"time":1489933620,"precipIntensity":0,"precipProbability":0},{"time":1489933680,"precipIntensity":0,"precipProbability":0},{"time":1489933740,"precipIntensity":0,"precipProbability":0},{"time":1489933800,"precipIntensity":0,"precipProbability":0},{"time":1489933860,"precipIntensity":0,"precipProbability":0},{"time":1489933920,"precipIntensity":0,"precipProbability":0},{"time":1489933980,"precipIntensity":0,"precipProbability":0},{"time":1489934040,"precipIntensity":0,"precipProbability":0},{"time":1489934100,"precipIntensity":0,"precipProbability":0},{"time":1489934160,"precipIntensity":0,"precipProbability":0},{"time":1489934220,"precipIntensity":0,"precipProbability":0},{"time":1489934280,"precipIntensity":0,"precipProbability":0},{"time":1489934340,"precipIntensity":0,"precipProbability":0},{"time":1489934400,"precipIntensity":0,"precipProbability":0},{"time":1489934460,"precipIntensity":0,"precipProbability":0},{"time":1489934520,"precipIntensity":0,"precipProbability":0},{"time":1489934580,"precipIntensity":0,"precipProbability":0},{"time":1489934640,"precipIntensity":0,"precipProbability":0},{"time":1489934700,"precipIntensity":0,"precipProbability":0},{"time":1489934760,"precipIntensity":0,"precipProbability":0},{"time":1489934820,"precipIntensity":0,"precipProbability":0},{"time":1489934880,"precipIntensity":0,"precipProbability":0},{"time":1489934940,"precipIntensity":0,"precipProbability":0},{"time":1489935000,"precipIntensity":0,"precipProbability":0},{"time":1489935060,"precipIntensity":0,"precipProbability":0},{"time":1489935120,"precipIntensity":0,"precipProbability":0},{"time":1489935180,"precipIntensity":0,"precipProbability":0},{"time":1489935240,"precipIntensity":0,"precipProbability":0},{"time":1489935300,"precipIntensity":0,"precipProbability":0},{"time":1489935360,"precipIntensity":0,"precipProbability":0},{"time":1489935420,"precipIntensity":0,"precipProbability":0},{"time":1489935480,"precipIntensity":0,"precipProbability":0},{"time":1489935540,"precipIntensity":0,"precipProbability":0},{"time":1489935600,"precipIntensity":0,"precipProbability":0},{"time":1489935660,"precipIntensity":0,"precipProbability":0},{"time":1489935720,"precipIntensity":0,"precipProbability":0},{"time":1489935780,"precipIntensity":0,"precipProbability":0},{"time":1489935840,"precipIntensity":0,"precipProbability":0},{"time":1489935900,"precipIntensity":0,"precipProbability":0}]},"hourly":{"summary":"Foggy tomorrow morning.","icon":"fog","data":[{"time":1489932000,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":-5.95,"apparentTemperature":-9.99,"dewPoint":-8.59,"humidity":0.82,"windSpeed":2.44,"windBearing":22,"visibility":16.09,"cloudCover":0.12,"pressure":1028.1,"ozone":373.76},{"time":1489935600,"summary":"Partly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":-3.41,"apparentTemperature":-7.16,"dewPoint":-5.41,"humidity":0.86,"windSpeed":2.59,"windBearing":27,"visibility":14.13,"cloudCover":0.45,"pressure":1028.18,"ozone":375.67},{"time":1489939200,"summary":"Partly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":-1.58,"apparentTemperature":-5.07,"dewPoint":-3.99,"humidity":0.84,"windSpeed":2.67,"windBearing":24,"visibility":14.52,"cloudCover":0.37,"pressure":1027.94,"ozone":378.86},{"time":1489942800,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":-0.15,"apparentTemperature":-3.36,"dewPoint":-3.11,"humidity":0.8,"windSpeed":2.65,"windBearing":24,"visibility":14.47,"cloudCover":0.22,"pressure":1027.54,"ozone":382.62},{"time":1489946400,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":1.2,"apparentTemperature":-1.56,"dewPoint":-2.27,"humidity":0.78,"windSpeed":2.45,"windBearing":26,"visibility":14.84,"cloudCover":0.11,"pressure":1027.15,"ozone":384.78},{"time":1489950000,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":2.57,"apparentTemperature":0.27,"dewPoint":-1.12,"humidity":0.77,"windSpeed":2.24,"windBearing":24,"visibility":15.1,"cloudCover":0.09,"pressure":1026.75,"ozone":384.35},{"time":1489953600,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":2.37,"apparentTemperature":0.16,"dewPoint":-1.34,"humidity":0.76,"windSpeed":2.14,"windBearing":17,"visibility":15.19,"cloudCover":0.12,"pressure":1026.26,"ozone":382.33},{"time":1489957200,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":1.38,"apparentTemperature":-0.62,"dewPoint":-2.16,"humidity":0.77,"windSpeed":1.81,"windBearing":1,"visibility":15.34,"cloudCover":0.14,"pressure":1025.98,"ozone":379.58},{"time":1489960800,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":-0.23,"apparentTemperature":-1.84,"dewPoint":-3.13,"humidity":0.81,"windSpeed":1.39,"windBearing":2,"visibility":15.39,"cloudCover":0.16,"pressure":1025.86,"ozone":375.9},{"time":1489964400,"summary":"Clear","icon":"clear-day","precipIntensity":0,"precipProbability":0,"temperature":-3.41,"apparentTemperature":-3.41,"dewPoint":-5.55,"humidity":0.85,"windSpeed":0.64,"windBearing":2,"visibility":14.71,"cloudCover":0.19,"pressure":1025.85,"ozone":371.5},{"time":1489968000,"summary":"Partly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-6.27,"apparentTemperature":-6.27,"dewPoint":-8.07,"humidity":0.87,"windSpeed":0.3,"windBearing":287,"visibility":13.21,"cloudCover":0.29,"pressure":1025.86,"ozone":367.82},{"time":1489971600,"summary":"Partly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-7.93,"apparentTemperature":-7.93,"dewPoint":-9.48,"humidity":0.89,"windSpeed":0.51,"windBearing":266,"visibility":10.64,"cloudCover":0.49,"pressure":1025.95,"ozone":365.75},{"time":1489975200,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-8.59,"apparentTemperature":-8.59,"dewPoint":-10.03,"humidity":0.89,"windSpeed":1.33,"windBearing":271,"visibility":7.64,"cloudCover":0.72,"pressure":1026.08,"ozone":364.4},{"time":1489978800,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-8.68,"apparentTemperature":-11.61,"dewPoint":-10.02,"humidity":0.9,"windSpeed":1.48,"windBearing":275,"visibility":5.83,"cloudCover":0.91,"pressure":1026.06,"ozone":362.61},{"time":1489982400,"summary":"Overcast","icon":"cloudy","precipIntensity":0,"precipProbability":0,"temperature":-8.74,"apparentTemperature":-11.77,"dewPoint":-10.24,"humidity":0.89,"windSpeed":1.52,"windBearing":272,"visibility":4.76,"cloudCover":0.95,"pressure":1025.77,"ozone":359.74},{"time":1489986000,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-9.08,"apparentTemperature":-11.99,"dewPoint":-10.53,"humidity":0.89,"windSpeed":1.44,"windBearing":266,"visibility":4.57,"cloudCover":0.93,"pressure":1025.33,"ozone":356.42},{"time":1489989600,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-9.37,"apparentTemperature":-9.37,"dewPoint":-10.83,"humidity":0.89,"windSpeed":1.15,"windBearing":260,"visibility":4.31,"cloudCover":0.9,"pressure":1024.93,"ozone":353.39},{"time":1489993200,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-9.03,"apparentTemperature":-9.03,"dewPoint":-10.08,"humidity":0.92,"windSpeed":1.06,"windBearing":264,"visibility":3.27,"cloudCover":0.91,"pressure":1024.61,"ozone":350.86},{"time":1489996800,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-8.83,"apparentTemperature":-8.83,"dewPoint":-9.56,"humidity":0.94,"windSpeed":0.96,"windBearing":265,"visibility":2.17,"cloudCover":0.91,"pressure":1024.3,"ozone":348.61},{"time":1490000400,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-8.87,"apparentTemperature":-8.87,"dewPoint":-9.4,"humidity":0.96,"windSpeed":0.85,"windBearing":262,"visibility":1.3,"cloudCover":0.91,"pressure":1024.02,"ozone":346.74},{"time":1490004000,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-9.09,"apparentTemperature":-9.09,"dewPoint":-9.52,"humidity":0.97,"windSpeed":0.76,"windBearing":251,"visibility":0.69,"cloudCover":0.91,"pressure":1023.79,"ozone":345.38},{"time":1490007600,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-8.29,"apparentTemperature":-8.29,"dewPoint":-8.63,"humidity":0.97,"windSpeed":0.68,"windBearing":235,"visibility":0,"cloudCover":0.91,"pressure":1023.58,"ozone":344.41},{"time":1490011200,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-7.96,"apparentTemperature":-7.96,"dewPoint":-8.38,"humidity":0.97,"windSpeed":0.69,"windBearing":219,"visibility":0.08,"cloudCover":0.91,"pressure":1023.31,"ozone":343.55},{"time":1490014800,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-6.63,"apparentTemperature":-6.63,"dewPoint":-7.24,"humidity":0.95,"windSpeed":0.68,"windBearing":207,"visibility":0,"cloudCover":0.94,"pressure":1022.99,"ozone":342.79},{"time":1490018400,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-4.72,"apparentTemperature":-4.72,"dewPoint":-5.61,"humidity":0.93,"windSpeed":0.71,"windBearing":201,"visibility":0,"cloudCover":0.98,"pressure":1022.56,"ozone":342.15},{"time":1490022000,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-2.73,"apparentTemperature":-2.73,"dewPoint":-3.92,"humidity":0.92,"windSpeed":0.81,"windBearing":196,"visibility":1.45,"cloudCover":0.99,"pressure":1022.01,"ozone":341.41},{"time":1490025600,"summary":"Overcast","icon":"cloudy","precipIntensity":0,"precipProbability":0,"temperature":-1.1,"apparentTemperature":-1.1,"dewPoint":-2.62,"humidity":0.89,"windSpeed":1.03,"windBearing":188,"visibility":5.89,"cloudCover":0.97,"pressure":1021.33,"ozone":340.27},{"time":1490029200,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":0.4,"apparentTemperature":0.4,"dewPoint":-1.49,"humidity":0.87,"windSpeed":1.3,"windBearing":182,"visibility":11.81,"cloudCover":0.92,"pressure":1020.55,"ozone":339.03},{"time":1490032800,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":1.74,"apparentTemperature":0.23,"dewPoint":-0.39,"humidity":0.86,"windSpeed":1.5,"windBearing":178,"visibility":16.09,"cloudCover":0.87,"pressure":1019.67,"ozone":338.38},{"time":1490036400,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":2.72,"apparentTemperature":1.23,"dewPoint":0.57,"humidity":0.86,"windSpeed":1.58,"windBearing":174,"visibility":16.09,"cloudCover":0.82,"pressure":1018.58,"ozone":338.74},{"time":1490040000,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":3.22,"apparentTemperature":1.79,"dewPoint":1.21,"humidity":0.87,"windSpeed":1.59,"windBearing":171,"visibility":16.09,"cloudCover":0.77,"pressure":1017.38,"ozone":339.69},{"time":1490043600,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":3.12,"apparentTemperature":1.7,"dewPoint":1.39,"humidity":0.88,"windSpeed":1.57,"windBearing":170,"visibility":16.09,"cloudCover":0.76,"pressure":1016.42,"ozone":340.63},{"time":1490047200,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":2.56,"apparentTemperature":1.1,"dewPoint":1.29,"humidity":0.91,"windSpeed":1.54,"windBearing":171,"visibility":16.09,"cloudCover":0.81,"pressure":1015.89,"ozone":341.27},{"time":1490050800,"summary":"Mostly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":1.86,"apparentTemperature":0.4,"dewPoint":1.14,"humidity":0.95,"windSpeed":1.48,"windBearing":173,"visibility":16.09,"cloudCover":0.9,"pressure":1015.56,"ozone":341.91},{"time":1490054400,"summary":"Overcast","icon":"cloudy","precipIntensity":0,"precipProbability":0,"temperature":1.37,"apparentTemperature":-0.18,"dewPoint":1.01,"humidity":0.97,"windSpeed":1.49,"windBearing":181,"visibility":16.09,"cloudCover":0.98,"pressure":1015.21,"ozone":342.81},{"time":1490058000,"summary":"Overcast","icon":"cloudy","precipIntensity":0,"precipProbability":0,"temperature":1.16,"apparentTemperature":-0.84,"dewPoint":0.88,"humidity":0.98,"windSpeed":1.79,"windBearing":196,"visibility":11.23,"cloudCover":1,"pressure":1014.86,"ozone":343.9},{"time":1490061600,"summary":"Overcast","icon":"cloudy","precipIntensity":0,"precipProbability":0,"temperature":1.04,"apparentTemperature":-1.59,"dewPoint":0.72,"humidity":0.98,"windSpeed":2.32,"windBearing":208,"visibility":4.6,"cloudCover":1,"pressure":1014.5,"ozone":345.25},{"time":1490065200,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":0.88,"apparentTemperature":-2.3,"dewPoint":0.52,"humidity":0.97,"windSpeed":2.84,"windBearing":216,"visibility":0.34,"cloudCover":0.99,"pressure":1014.03,"ozone":347.36},{"time":1490068800,"summary":"Foggy","icon":"fog","precipIntensity":0.0406,"precipProbability":0.03,"precipType":"snow","precipAccumulation":0.03,"temperature":0.64,"apparentTemperature":-3.02,"dewPoint":0.31,"humidity":0.98,"windSpeed":3.34,"windBearing":221,"visibility":0.74,"cloudCover":1,"pressure":1013.37,"ozone":350.43},{"time":1490072400,"summary":"Flurries","icon":"snow","precipIntensity":0.0813,"precipProbability":0.11,"precipType":"snow","precipAccumulation":0.061,"temperature":0.48,"apparentTemperature":-3.52,"dewPoint":0.2,"humidity":0.98,"windSpeed":3.75,"windBearing":225,"visibility":3.51,"cloudCover":1,"pressure":1012.6,"ozone":354.25},{"time":1490076000,"summary":"Light Snow","icon":"snow","precipIntensity":0.1016,"precipProbability":0.15,"precipType":"snow","precipAccumulation":0.079,"temperature":0.39,"apparentTemperature":-3.78,"dewPoint":0.13,"humidity":0.98,"windSpeed":3.98,"windBearing":229,"visibility":5.7,"cloudCover":0.99,"pressure":1011.95,"ozone":358.67},{"time":1490079600,"summary":"Overcast","icon":"cloudy","precipIntensity":0.0813,"precipProbability":0.11,"precipType":"sleet","temperature":0.33,"apparentTemperature":-3.83,"dewPoint":0.02,"humidity":0.98,"windSpeed":3.93,"windBearing":234,"visibility":6.28,"cloudCover":0.96,"pressure":1011.46,"ozone":363.95},{"time":1490083200,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0.0381,"precipProbability":0.03,"precipType":"sleet","temperature":0.27,"apparentTemperature":-3.73,"dewPoint":-0.13,"humidity":0.97,"windSpeed":3.69,"windBearing":241,"visibility":6.29,"cloudCover":0.92,"pressure":1011.08,"ozone":369.82},{"time":1490086800,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-0.06,"apparentTemperature":-3.94,"dewPoint":-0.54,"humidity":0.97,"windSpeed":3.45,"windBearing":249,"visibility":5.92,"cloudCover":0.87,"pressure":1010.9,"ozone":375.38},{"time":1490090400,"summary":"Mostly Cloudy","icon":"partly-cloudy-night","precipIntensity":0,"precipProbability":0,"temperature":-0.47,"apparentTemperature":-4.25,"dewPoint":-1.02,"humidity":0.96,"windSpeed":3.21,"windBearing":258,"visibility":4.51,"cloudCover":0.79,"pressure":1011.01,"ozone":380.29},{"time":1490094000,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-1.15,"apparentTemperature":-4.88,"dewPoint":-1.79,"humidity":0.95,"windSpeed":3,"windBearing":270,"visibility":2.7,"cloudCover":0.68,"pressure":1011.33,"ozone":384.88},{"time":1490097600,"summary":"Foggy","icon":"fog","precipIntensity":0,"precipProbability":0,"temperature":-1.3,"apparentTemperature":-4.82,"dewPoint":-2.05,"humidity":0.95,"windSpeed":2.75,"windBearing":271,"visibility":2.75,"cloudCover":0.58,"pressure":1011.68,"ozone":389.26},{"time":1490101200,"summary":"Partly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":-0.48,"apparentTemperature":-3.77,"dewPoint":-1.39,"humidity":0.94,"windSpeed":2.67,"windBearing":267,"visibility":6.47,"cloudCover":0.49,"pressure":1012.14,"ozone":393.49},{"time":1490104800,"summary":"Partly Cloudy","icon":"partly-cloudy-day","precipIntensity":0,"precipProbability":0,"temperature":0.84,"apparentTemperature":-2.19,"dewPoint":-0.27,"humidity":0.92,"windSpeed":2.67,"windBearing":259,"visibility":12.02,"cloudCover":0.4,"pressure":1012.53,"ozone":397.51}]},"daily":{"summary":"Mixed precipitation on Tuesday through Sunday, with temperatures bottoming out at -5°C on Wednesday.","icon":"snow","data":[{"time":1489896000,"summary":"Mostly cloudy starting in the evening.","icon":"partly-cloudy-night","sunriseTime":1489921276,"sunsetTime":1489964851,"moonPhase":0.72,"precipIntensity":0,"precipIntensityMax":0,"precipProbability":0,"temperatureMin":-9.79,"temperatureMinTime":1489906800,"temperatureMax":2.57,"temperatureMaxTime":1489950000,"apparentTemperatureMin":-13.45,"apparentTemperatureMinTime":1489906800,"apparentTemperatureMax":0.27,"apparentTemperatureMaxTime":1489950000,"dewPoint":-7.33,"humidity":0.81,"windSpeed":1.61,"windBearing":11,"visibility":16.09,"cloudCover":0.21,"pressure":1026.62,"ozone":373.74},{"time":1489982400,"summary":"Light snow overnight.","icon":"snow","sunriseTime":1490007561,"sunsetTime":1490051329,"moonPhase":0.75,"precipIntensity":0,"precipIntensityMax":0,"precipProbability":0,"temperatureMin":-9.37,"temperatureMinTime":1489989600,"temperatureMax":3.22,"temperatureMaxTime":1490040000,"apparentTemperatureMin":-11.99,"apparentTemperatureMinTime":1489986000,"apparentTemperatureMax":1.79,"apparentTemperatureMaxTime":1490040000,"dewPoint":-4.16,"humidity":0.93,"windSpeed":1.07,"windBearing":207,"visibility":7.18,"cloudCover":0.91,"pressure":1020.47,"ozone":344.78},{"time":1490068800,"summary":"Foggy in the morning.","icon":"fog","sunriseTime":1490093845,"sunsetTime":1490137807,"moonPhase":0.78,"precipIntensity":0.0279,"precipIntensityMax":0.1016,"precipIntensityMaxTime":1490076000,"precipProbability":0.15,"precipType":"snow","precipAccumulation":0.546,"temperatureMin":-5.48,"temperatureMinTime":1490151600,"temperatureMax":4.7,"temperatureMaxTime":1490126400,"apparentTemperatureMin":-11.83,"apparentTemperatureMinTime":1490151600,"apparentTemperatureMax":1.36,"apparentTemperatureMaxTime":1490126400,"dewPoint":-0.72,"humidity":0.91,"windSpeed":3.14,"windBearing":254,"visibility":11.15,"cloudCover":0.54,"pressure":1012.19,"ozone":399.55},{"time":1490155200,"summary":"Flurries starting in the afternoon, continuing until evening.","icon":"snow","sunriseTime":1490180130,"sunsetTime":1490224285,"moonPhase":0.81,"precipIntensity":0.0102,"precipIntensityMax":0.0229,"precipIntensityMaxTime":1490212800,"precipProbability":0.01,"precipType":"snow","precipAccumulation":0.404,"temperatureMin":-14.23,"temperatureMinTime":1490184000,"temperatureMax":-4.78,"temperatureMaxTime":1490155200,"apparentTemperatureMin":-21.99,"apparentTemperatureMinTime":1490184000,"apparentTemperatureMax":-11.13,"apparentTemperatureMaxTime":1490155200,"dewPoint":-14.87,"humidity":0.71,"windSpeed":4.68,"windBearing":295,"visibility":16.09,"cloudCover":0.37,"pressure":1025.97,"ozone":463.84},{"time":1490241600,"summary":"Mostly cloudy overnight.","icon":"partly-cloudy-night","sunriseTime":1490266414,"sunsetTime":1490310762,"moonPhase":0.85,"precipIntensity":0,"precipIntensityMax":0,"precipProbability":0,"temperatureMin":-11.94,"temperatureMinTime":1490266800,"temperatureMax":0.64,"temperatureMaxTime":1490302800,"apparentTemperatureMin":-17.94,"apparentTemperatureMinTime":1490266800,"apparentTemperatureMax":-3.59,"apparentTemperatureMaxTime":1490302800,"dewPoint":-8.66,"humidity":0.84,"windSpeed":3.92,"windBearing":263,"cloudCover":0.1,"pressure":1032.64,"ozone":431.54},{"time":1490328000,"summary":"Light rain starting in the afternoon.","icon":"rain","sunriseTime":1490352699,"sunsetTime":1490397240,"moonPhase":0.88,"precipIntensity":0.0787,"precipIntensityMax":0.2286,"precipIntensityMaxTime":1490392800,"precipProbability":0.48,"precipType":"snow","precipAccumulation":1.45,"temperatureMin":-5.48,"temperatureMinTime":1490346000,"temperatureMax":5.02,"temperatureMaxTime":1490410800,"apparentTemperatureMin":-8.17,"apparentTemperatureMinTime":1490349600,"apparentTemperatureMax":3.49,"apparentTemperatureMaxTime":1490410800,"dewPoint":-1.99,"humidity":0.89,"windSpeed":1.55,"windBearing":154,"cloudCover":0.88,"pressure":1026.2,"ozone":346.87},{"time":1490414400,"summary":"Mixed precipitation (6–13 cm. of snow) throughout the day.","icon":"rain","sunriseTime":1490438983,"sunsetTime":1490483718,"moonPhase":0.91,"precipIntensity":0.635,"precipIntensityMax":1.6231,"precipIntensityMaxTime":1490490000,"precipProbability":0.75,"precipType":"rain","temperatureMin":-0.21,"temperatureMinTime":1490497200,"temperatureMax":8.39,"temperatureMaxTime":1490461200,"apparentTemperatureMin":-5.23,"apparentTemperatureMinTime":1490497200,"apparentTemperatureMax":5.35,"apparentTemperatureMaxTime":1490461200,"dewPoint":4.54,"humidity":0.96,"windSpeed":1.12,"windBearing":270,"cloudCover":1,"pressure":1013.91,"ozone":328.48},{"time":1490500800,"summary":"Snow (2–5 cm.) throughout the day.","icon":"snow","sunriseTime":1490525268,"sunsetTime":1490570195,"moonPhase":0.95,"precipIntensity":0.2769,"precipIntensityMax":1.3335,"precipIntensityMaxTime":1490500800,"precipProbability":0.73,"precipType":"snow","precipAccumulation":7.198,"temperatureMin":-6.77,"temperatureMinTime":1490533200,"temperatureMax":-0.47,"temperatureMaxTime":1490500800,"apparentTemperatureMin":-14.46,"apparentTemperatureMinTime":1490533200,"apparentTemperatureMax":-5.62,"apparentTemperatureMaxTime":1490500800,"dewPoint":-6.29,"humidity":0.85,"windSpeed":5.82,"windBearing":44,"cloudCover":0.77,"pressure":1024.11,"ozone":363.71}]},"alerts":[{"title":"Winter Storm Watch","regions":["Hemmingford area","Huntingdon area","Saint-Rémi area","Soulanges area","Valleyfield - Beauharnois area","Vaudreuil area"],"severity":"watch","time":1489393620,"description":"Heavy snow and blowing snow on tap beginning Tuesday morning... A low pressure system developing over the Central United States will track toward the coast of New England on Tuesday as it intensifies. According to the latest analyses, this system will hit much of Southern and Central Quebec with snow beginning Tuesday morning. Snowfall amounts expected through Wednesday evening could exceed 15 and even 25 centimetres over a number of areas, especially in the Eastern Townships and Beauce regions. In addition, strong northeasterly winds will develop resulting in widespread blowing snow. Visibility may be suddenly reduced at times in heavy snow. There may be a significant impact on rush hour traffic in urban areas. Please continue to monitor alerts and forecasts issued by Environment Canada. To report severe weather, send an email to ec.cpiq_tempetes-qspc_storms.ec@canada.ca or tweet reports using #meteoqc.","uri":"https://weather.gc.ca/warnings/report_e.html?qc66"},{"title":"Winter Storm Watch","regions":["Châteauguay - La Prairie area","Laval area","Longueuil - Varennes area","Montréal Island area"],"severity":"watch","time":1489393620,"description":"Heavy snow and blowing snow on tap beginning Tuesday morning... A low pressure system developing over the Central United States will track toward the coast of New England on Tuesday as it intensifies. According to the latest analyses, this system will hit much of Southern and Central Quebec with snow beginning Tuesday morning. Snowfall amounts expected through Wednesday evening could exceed 15 and even 25 centimetres over a number of areas, especially in the Eastern Townships and Beauce regions. In addition, strong northeasterly winds will develop resulting in widespread blowing snow. Visibility may be suddenly reduced at times in heavy snow. There may be a significant impact on rush hour traffic in urban areas. Please continue to monitor alerts and forecasts issued by Environment Canada. To report severe weather, send an email to ec.cpiq_tempetes-qspc_storms.ec@canada.ca or tweet reports using #meteoqc.","uri":"https://weather.gc.ca/warnings/report_e.html?qc67"}],"flags":{"sources":["gfs","cmc","nam","rap","rtma","sref","fnmoc","isd","madis","nearest-precip","ecpa","darksky"],"isd-stations":["711830-99999","711840-99999","713710-99999","713713-99999","713720-99999","713770-99999","713985-99999","715240-99999","716120-99999","716140-99999","716260-99999","716270-94792","716270-99999","716275-99999","719050-99999","999999-94792"],"madis-stations":["AS947","C3442","C7439","C8027","C8480","CWTA","CWVQ","CYMX","CYUL","D2821","D3464","D8252","E5619","VCBW","VCWS","XJBH"],"units":"si"}}';
	var data = $.parseJSON(sampleDataWithAlerts);
	showData(data);
    */
		
	$.ajax({
            type: 'GET',
            url: url,
            cache: false,
            dataType: "jsonp",
            success: function (data) {
                showData(data);
            },
            error: function () {
                console.log("An error occurred.");
				debugger;
            }
        });
}

function showData(data) {
    showAlerts(data.alerts);
    showCurrent(data.currently, data.daily.summary);
    if (forecastNbOfDays > 0) { showForecast(data.daily.data); }
    if (hourlyNbOfHours > 0) { showHourlyForecast(data.hourly.data); }
}

function showAlerts(alerts) {
    var divAlerts = $("#alerts");

    if (alerts != null && alerts.length > 0) {
        hasAlerts = true;
        var alertMessages = [];
        $.each(alerts, function (index, alert) {
            alertMessages.push(alert.title + ": " + alert.description);
        });

        divAlerts.text(alertMessages.join(" | "));
        divAlerts.show();     
    }
    else {
        hasAlerts = false;
        divAlerts.hide();     
    }
}

function showCurrent(current, summary) {
	$("#currentSummary").html(summary);
	setIcon(current.icon, "#currentIcon", true);	
	$("#currentTemp").text(getTemp(current.temperature));
	$("#currentApparentTemp").text(getTemp(current.apparentTemperature));	
	$("#currentPrec").text(getProbability(current.precipProbability));
    $("#currentWind").html(getWind(current.windSpeed, current.windBearing, showCurrentWindBearing));
    $("#currentHumidity").html(getProbability(current.humidity) + '<span>%</span>');
}

function showDateTime() {
	var now = new Date();
	$("#currentDate").text(week[now.getDay()] + ', ' + now.getDate() + ' ' + month[now.getMonth()]);
	$("#currentTime").text(now.getHours() + (now.getMinutes() < 10 ? ":0" : ":") + now.getMinutes());
}

function showForecast(days) {
    var i = 0;
    var now = (new Date()).setHours(0, 0, 0, 0);
    var titles = [];
    var icons = [];
    var summaries = [];
    var maxTemps = [];
    var minTemps = [];
    var winds = [];
    var humidities = [];
    var precipitations = [];
    var accumulations = [];
    
    $.each(days, function (index, day) {
        if (i >= forecastNbOfDays)
        { return false; }

        var dateTime = new Date(0);
        dateTime.setUTCSeconds(day.time);
        var dayDate = dateTime.setHours(0, 0, 0, 0);
        if (dayDate >= now || debugging) {
            titles.push('<th>' + (dayDate == now ? todayLabel : week[dateTime.getDay()]) + '</th>');
            icons.push('<td><i class="' + getIconClass(day.icon, false) + '"></i></td>');
            summaries.push('<td>' + day.summary + '</td>');
            maxTemps.push('<td>' + getTemp(day.temperatureMax) + '</td>');
            minTemps.push('<td>' + getTemp(day.apparentTemperatureMin) + '</td>');
            winds.push('<td>' + getWind(day.windSpeed, day.windBearing, showForecastWindBearing) + '</td>');
            humidities.push('<td>' + getProbability(day.humidity) + '%' + '</td>');
            precipitations.push('<td>' + getProbability(day.precipProbability) + '%' + '</td>');
			accumulations.push('<td>' + getAccumulationStr(day, 24) + '</td>');
			
            i++;
        }
    });

    $("#forecastTitles").html('<th></th>' + titles.join(""));
    $("#forecastIcons").html('<td></td>' + icons.join(""));
    $("#forecastSummaries").html('<td></td>' + summaries.join(""));
    $("#forecastMaxTemps").html('<td><div class="vertical">max</div></td>' + maxTemps.join(""));
    $("#forecastMinTemps").html('<td><div class="vertical">min</div></td>' + minTemps.join(""));
    $("#forecastWind").html('<td><div class="vertical">wind</div></td>' + winds.join(""));
    $("#forecastHumidity").html('<td><div class="vertical">rh</div></td>' + humidities.join(""));
    $("#forecastPrecipitations").html('<td><div class="vertical">prob</div></td>' + precipitations.join(""));
    $("#forecastAccumulations").html('<td><div class="vertical">acc</div></td>' + accumulations.join(""));

    var width = Math.floor(100 / forecastNbOfDays);
    $("#forecast td").css('width', width + '%');
    $("#forecastSummaries td").css('fontSize', hasAlerts ?'14px': '16px');
}

function showHourlyForecast(hourlyForecasts) {
    var hours = [];
    var icons = [];
    var temps = [];
    var winds = [];
    var humidities = [];
	var accumulations = [];
    var precipitations = [];
    var i = 0;
    var now = new Date();
    now = now.setHours(now.getHours(), 0, 0, 0);

    $.each(hourlyForecasts, function (index, hourly) {
        var dateTime = new Date(0);
        dateTime.setUTCSeconds(hourly.time);
        var dayDate = dateTime.setHours(dateTime.getHours(), 0, 0, 0);
        if (dayDate >= now || debugging) {
            hours.push("<th>" + dateTime.getHours() + "h</th>");
            if (showHourlyIcon){icons.push('<td><i class="' + getIconClass(hourly.icon, true) + '"></i></td>');}
            temps.push('<td>' + Math.round(hourly.temperature) + '°</td>');
            winds.push('<td>' + getWind(hourly.windSpeed, hourly.windBearing, showHourlyWindBearing) + '</td>');
            humidities.push('<td><span style="font-size:12px">rh</span> ' + getProbability(hourly.humidity) + '<span>%</span></td>');
            accumulations.push('<td>' + getAccumulationStr(hourly, 1) + '</td>');
            precipitations.push('<td>' + getProbability(hourly.precipProbability) + '<span>%</span></td>');
        }
        i++;

        if (i >= hourlyNbOfHours) {
            return false;
        }
    });

    $("#hourlyHours").html(hours.join(""));
    $("#hourlyIcons").html(icons.join(""));
    $("#hourlyTemp").html(temps.join(""));	
    $("#hourlyWind").html(winds.join(""));	
    $("#hourlyHumidity").html(humidities.join(""));	
	$("#hourlyAcc").html(accumulations.join(""));	
	$("#hourlyPrec").html(precipitations.join(""));	
}

function hideUnwantedData()
{
	if (forecastNbOfDays == 0) { $("#forecast").remove(); }
	if (hourlyNbOfHours == 0) { $("#tableHourlyForecast").remove(); }
	if (!showScrollingAlerts) { $("#alerts").remove(); }
	if (!showCurrentWeather) { $("#header").remove(); }
    if (!showCurrentIcon) { $("#currentIcon").remove(); }
    if (!showCurrentWind) { $("#windLabel").remove(); $("#currentWind").remove(); }
    if (!showCurrentHumidity) { $("#currentHumidity").remove(); $("#humidityLabel").remove(); }
	if (!showCurrentSummary) { $("#currentSummary").remove(); }
	if (!showCurrentDate) { $("#currentDate").remove(); }
	if (!showCurrentTime) { $("#currentTime").remove(); }
	if (!showForecastIcon) { $("#forecastIcons").remove(); }
	if (!showForecastSummary) { $("#forecastSummaries").remove(); }
    if (!showForecastMinTemp) { $("#forecastMinTemps").remove(); }
    if (!showForecastWind) { $("#forecastWind").remove(); }
    if (!showForecastHumidity) { $("#forecastHumidity").remove(); }
	if (!showForecastAccumulation) { $("#forecastAccumulations").remove(); }
	if (!showForecastProbability) { $("#forecastPrecipitations").remove(); }
    if (!showHourlyIcon) { $("#hourlyIcons").remove(); }
    if (!showHourlyWind) { $("#hourlyWind").remove(); }
    if (!showHourlyHumidity) { $("#hourlyHumidity").remove(); }
	if (!showHourlyAccumulation) { $("#hourlyAcc").remove(); }
	if (!showHourlyProbability) { $("#hourlyPrec").remove(); }
	if (!showDarkSkyLink) { $("#darkSkyLink").remove(); }
}

function setIcon(icon, id, keepNight) {
	$(id).attr('class', getIconClass(icon, keepNight));
}

function getIconClass(icon, keepNight, isVisible) {
    return 'icon icon-' + (keepNight ? icon.replace(/-|day/ig, "") : icon.replace(/-|day|night/ig, ""));
}

function getTemp(temp) {
    return Math.round(temp) + '°' + degreeSymbol;
}

function getProbability(probability) {
    return probability == null ? 0 : Math.round(probability * 100);
}

function getAccumulationStr(forecastItem, multiplier)
{
	var accumulation = forecastItem.precipAccumulation != null ? forecastItem.precipAccumulation :
						       (forecastItem.precipIntensity != null ? forecastItem.precipIntensity * multiplier : 0);
							   
	var acc = (accumulation > 0 && accumulation < 1) ? (Math.round(accumulation*10)/10).toString().replace("0.",".") : Math.round(accumulation)
	return acc + '<span style="font-size:14px">' + (forecastItem.precipType == 'snow' ? snowPrecUnit : rainPrecUnit) + '</span>';
}

function getWind(speed, deg, showWindBearing) {
    var strWind = '<span>' + Math.round(speed) + '</span>' + windUnit;
    if (showWindBearing)
    {
        strWind = strWind + '<span class="windContainer"><span class="wind" style="transform: rotate(' + deg + 'deg);">↑</span></span>'
    }
    return strWind;
}